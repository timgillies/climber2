<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag 'application', "https://fonts.googleapis.com/css?family=Lato:300,400" , media: 'all' %>
    <script src="https://use.typekit.net/hfq0pei.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    <%= javascript_include_tag 'application' %>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>

    <script>
      $ ->
        loadFacebookSDK()
        bindFacebookEvents() unless window.fbEventsBound

      bindFacebookEvents = ->
        $(document)
          .on('page:fetch', saveFacebookRoot)
          .on('page:change', restoreFacebookRoot)
          .on('page:load', ->
            FB?.XFBML.parse()
          )
        @fbEventsBound = true

      saveFacebookRoot = ->
        if $('#fb-root').length
          @fbRoot = $('#fb-root').detach()

      restoreFacebookRoot = ->
        if @fbRoot?
          if $('#fb-root').length
            $('#fb-root').replaceWith @fbRoot
          else
            $('body').append @fbRoot

      loadFacebookSDK = ->
        window.fbAsyncInit = initializeFacebookSDK
        $.getScript("//connect.facebook.net/en_US/sdk.js")

      initializeFacebookSDK = ->
        FB.init
          appId  : ENV['FACEBOOK_APP_ID']
          status : true
          cookie : true
          xfbml  : true
          version: 'v2.7'
    </script>

  </head>
  <body>


    <%= render 'layouts/header' %>
    <%= render 'layouts/adminheader' %>
    <div class="container">
      <br/>
      <%= render 'layouts/messages' %>
      <%= yield %>
      <%= render 'layouts/footer' %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  </body>
</html>
